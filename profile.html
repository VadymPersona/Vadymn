<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Major Profile</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #000; color: white; font-family: -apple-system, sans-serif; padding-bottom: 100px; }
        .card-grad { 
            background: linear-gradient(145deg, #1a1a1a 0%, #050505 100%); 
            border: 1px solid rgba(255,255,255,0.08); 
            border-radius: 30px;
        }
        .nav-blur {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        #ton-connect-button button { background-color: #248bf2 !important; border-radius: 12px !important; width: 100% !important; }
        .btn-donate {
            background: linear-gradient(90deg, #248bf2, #0052cc);
            transition: all 0.2s ease;
        }
        .btn-donate:active { scale: 0.95; opacity: 0.8; }
    </style>
</head>
<body class="p-6">

    <div class="flex flex-col items-center mt-4 mb-8">
        <div class="relative mb-3">
            <img id="user-avatar" src="" class="w-20 h-20 rounded-full border-2 border-zinc-800 object-cover opacity-0 transition-opacity duration-500">
            <div id="loader" class="absolute inset-0 bg-zinc-900 rounded-full animate-pulse"></div>
        </div>
        <h1 id="user-name" class="text-xl font-bold">...</h1>
        <p id="user-username" class="text-zinc-500 text-xs">@username</p>
    </div>

    <div class="card-grad p-6 mb-4">
        <div class="flex justify-between items-start mb-8">
            <div>
                <p class="text-[10px] uppercase tracking-widest text-zinc-500 font-bold mb-1">Wallet Connection</p>
                <div id="ton-connect-button"></div>
            </div>
            <div class="px-2 py-1 bg-zinc-800 rounded-lg text-[10px] text-zinc-400">TON</div>
        </div>

        <div id="donation-block" class="opacity-30 pointer-events-none transition-all duration-500">
            <p class="text-[10px] uppercase tracking-widest text-zinc-400 font-bold mb-3">Support Token (Donation)</p>
            <button onclick="sendDonation()" class="btn-donate w-full py-4 rounded-2xl font-bold text-sm shadow-lg shadow-blue-500/20">
                Donate 0.001 TON
            </button>
            <p class="text-[9px] text-zinc-500 mt-2 text-center italic">–°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ–π–¥—É—Ç –Ω–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞</p>
        </div>
    </div>

    <div id="status-msg" class="text-center text-[10px] font-bold uppercase tracking-widest py-2"></div>

    <div class="fixed bottom-0 left-0 right-0 h-20 nav-blur flex justify-around items-center px-6 z-50">
        <a href="index.html" class="flex flex-col items-center gap-1 opacity-50">
            <span class="text-2xl">üè†</span>
            <span class="text-[10px] font-medium uppercase tracking-tighter">–ì–ª–∞–≤–Ω–∞—è</span>
        </a>
        <div class="flex flex-col items-center gap-1 text-blue-500">
            <span class="text-2xl">üë§</span>
            <span class="text-[10px] font-bold uppercase tracking-tighter">–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
        const MY_WALLET_ADDRESS = "UQBAshgLU8AMuBwOQjzbpE127NjtI8g9PfoVtGtVCy9SS_kg"; // –í—Å—Ç–∞–≤—å —Å–≤–æ–π –∞–¥—Ä–µ—Å TON (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ UQ... –∏–ª–∏ EQ...)

        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://vadympersona.github.io/Vadymn/tonconnect-manifest.json',
            buttonRootId: 'ton-connect-button'
        });

        // –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
        const user = tg.initDataUnsafe?.user;
        if (user) {
            document.getElementById('user-name').innerText = user.first_name;
            document.getElementById('user-username').innerText = user.username ? `@${user.username}` : '';
            const avatar = document.getElementById('user-avatar');
            avatar.src = user.photo_url || `https://t.me/i/userpic/320/${user.username || 'default'}.jpg`;
            avatar.onload = () => {
                avatar.classList.remove('opacity-0');
                document.getElementById('loader').style.display = 'none';
            }
        }

        // –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–Ω–æ–ø–∫–∏ –¥–æ–Ω–∞—Ç–∞
        tonConnectUI.onStatusChange(wallet => {
            const donateBlock = document.getElementById('donation-block');
            if (wallet) {
                donateBlock.classList.remove('opacity-30', 'pointer-events-none');
            } else {
                donateBlock.classList.add('opacity-30', 'pointer-events-none');
            }
        });

        // –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –î–ï–ù–ï–ì
        async function sendDonation() {
            const transaction = {
                validUntil: Math.floor(Date.now() / 1000) + 600, // 10 –º–∏–Ω—É—Ç –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                messages: [
                    {
                        address: MY_WALLET_ADDRESS, // –¢–≤–æ–π –∞–¥—Ä–µ—Å
                        amount: "1000000", // 0.001 TON –≤ –Ω–∞–Ω–æ—Ç–æ–Ω–∞—Ö (1 TON = 1,000,000,000)
                    }
                ]
            };

            try {
                const statusEl = document.getElementById('status-msg');
                statusEl.innerText = "–û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è...";
                statusEl.className = "text-yellow-500 text-[10px] font-bold uppercase text-center";

                const result = await tonConnectUI.sendTransaction(transaction);
                
                statusEl.innerText = "‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É!";
                statusEl.className = "text-green-500 text-[10px] font-bold uppercase text-center";
                tg.HapticFeedback.notificationOccurred('success');
            } catch (e) {
                console.error(e);
                document.getElementById('status-msg').innerText = "‚ùå –û—à–∏–±–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏";
                document.getElementById('status-msg').className = "text-red-500 text-[10px] font-bold uppercase text-center";
                tg.HapticFeedback.notificationOccurred('error');
            }
        }
    </script>
</body>
</html>